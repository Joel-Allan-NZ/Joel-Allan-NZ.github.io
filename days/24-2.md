---
slug: '/2024/2'
year: 2024
puzz: 2
---

## Part One

Another simple problem to warm us up. We must count all lines in the input such that there's a monotonic increase (or decrease) beween values on that line,
and no consecutive values on the line have a difference greater than 3.

I chose to approach it by considering each number but the last, and comparing them to the number at the next index, discovering if we're increasing or decreasing from the first pair of values.

There is a cost to this (we need to check equality between the paired values), but a more efficient solution doesn't leap to mind. At least `Array.prototype.every()` stops evaluating as soon as it resolves a failure.

```js
function partOne(input: string[]): number | string {
  return input.reduce((sum, current) => {
    const parsedLine = current.split(/\s+/).map((y) => parseInt(y))
    return areLevelsSafe(parsedLine) ? sum + 1 : sum
  }, 0)
}

function areLevelsSafe(levels: number[]): boolean {
  let increasing: boolean | null = null

  return levels.slice(0, -1).every((current, index) => {
    increasing ??= levels[index + 1] > current

    return (
      increasing == levels[index + 1] > current &&
      levels[index + 1] != current &&
      Math.abs(levels[index + 1] - current) < 4
    )
  })
}
```

## Part Two

Identical to part one, except if a line fails we must then also check if the line has at most a single 'bad' value. My somewhat lazy approach is to just feed partial lines back into `areLevelsSafe()`, using `Array.prototype.find()` to stop checking sub-lines on a success.

```js
export function partTwo(input: string[]): number | string {
  return input.reduce((sum, current) => {
    const parsedLine = current.split(/\s+/).map((y) => parseInt(y))
    return areLevelsSafeWithDampener(parsedLine) ? sum + 1 : sum
  }, 0)
}

function areLevelsSafeWithDampener(levels: number[]): boolean {
  if (areLevelsSafe(levels)) return true

  return (
    levels.find((level, index) => {
      return areLevelsSafe([
        ...levels.slice(0, index),
        ...levels.slice(index + 1),
      ])
    }) !== undefined
  )
}
```
